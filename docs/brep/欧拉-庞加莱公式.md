# 从欧拉-庞加莱公式到B-Rep

> [The Euler-Poincaré Formula (mtu.edu)](https://pages.mtu.edu/~shene/COURSES/cs3621/NOTES/model/euler.html)
>
> [Euler operator (digital geometry) - Wikipedia](https://en.wikipedia.org/wiki/Euler_operator_(digital_geometry))

## 欧拉公式

三维形体的欧拉公式（欧拉-庞加莱公式）如下：

$$
\chi = V - E + F = 2 (S-G) + (L-F),
$$

其中$\chi$为欧拉示性数，$V$为顶点数，$E$为边数，$F$为面数，$S$为三维形体数，$G$为亏格数，$L$为环数，

$$
R = L-F
$$

为内面环（interior face ring）数。

当$S-G=1,L=F$时，退化为平面图的欧拉公式$V-E+F=2$。

当三维形体奇异（如一条边与多于两个面关联）时，上述等式不一定成立。当上述等式对于某形体系统不成立时，该形体系统一定不是三维形体。

## 欧拉操作

给定一个三维形体，欧拉操作是一系列不改变其欧拉示性数的拓扑操作（*Handbook of CAGD, 20th chapter*），如

* `mev`，增加（make）一条边（edge）和一个顶点（vertex），可见$V$和$E$的增加抵消了，欧拉示性数不变。
* `mef`，增加一条边和一个面。

但有时为了方便，把一些改变欧拉示性数的拓扑操作也称作欧拉操作，如

* 用于新建形体的 `mvsf`，向空集增加一个顶点（vertex），形成一个三维形体（solid），一个面（face）。这一操作的前后欧拉示性数为$0 \to 2$。
* `kemr`，删除（kill）一条边，增加一个环（ring）。
* `kfmrh`，删除一个面，增加一个环，一个半边（half-edge）。

## 边界表示

边界表示（Boundary representation, B-rep）是一种表达三维形体的方法，聚焦于表示物体的边界，多采用半边数据结构和欧拉操作进行建模。

# 体素构造CSG

CSG（Constructive Solid Geometry）体素构造表示法把复杂的实体，看成由若干较简单的最基本实体经过一些有序的布尔运算而构造出来，这些简单的最基本的实体称为体素。

CSG树是一系列二元运算表达式树，运算符可由并、交、差、正则并、正则交、正则差等布尔运算构成。
